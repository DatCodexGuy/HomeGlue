{% extends "ui/base.html" %}
{% load ui_extras %}
{% block title %}Shared Password | HomeGlue{% endblock %}
{% block content %}
  <section class="panel reveal" style="max-width:840px; margin:0 auto">
    <div class="listhead">
      <div>
        <h1 class="h2">{% if share.label %}{{ share.label }}{% else %}Shared Password{% endif %}</h1>
        <div class="sub">
          {{ entry.name }}
          <span class="dot"></span>
          Expires {{ share.expires_at|date:"Y-m-d H:i" }}
          {% if share.one_time %}<span class="dot"></span><span class="pill pill--tiny pill--ghost">one-time</span>{% endif %}
        </div>
      </div>
    </div>

    {% if share.revoked_at %}
      <div class="warn">
        <div class="warn__title">Link revoked</div>
        <div class="warn__body">This share link was revoked and can no longer be used.</div>
      </div>
    {% elif share.expires_at and share.expires_at < now %}
      <div class="warn">
        <div class="warn__title">Link expired</div>
        <div class="warn__body">This share link has expired.</div>
      </div>
    {% elif share.one_time and share.consumed_at %}
      <div class="warn">
        <div class="warn__title">Link consumed</div>
        <div class="warn__body">This one-time link was already used and can no longer be revealed.</div>
      </div>
    {% endif %}

    <div class="mini" style="margin-top:12px">
      {% if entry.username %}<div class="mini__row"><div class="muted">Username</div><div class="mono">{{ entry.username }}</div></div>{% endif %}
      {% if entry.url %}<div class="mini__row"><div class="muted">URL</div><div class="mono">{{ entry.url }}</div></div>{% endif %}
    </div>

    <h3 class="h3" style="margin-top:16px">Reveal</h3>
    <div class="warn">
      <div class="warn__title">Sensitive</div>
      <div class="warn__body">Treat screenshots, browser history, and screen sharing as sensitive.</div>
    </div>

    {% if password %}
      <div class="secretbox" style="margin-top:10px">
        <div class="secretbox__label">Password</div>
        <div class="secretbox__value mono" data-copy>{{ password }}</div>
        <div class="muted">Click to copy</div>
      </div>
      {% if share.one_time %}
        <div class="sub" style="margin-top:10px">
          This was a one-time link. Reloading this page will not reveal the password again.
        </div>
      {% endif %}
    {% else %}
      {% if active %}
        <form method="post" style="margin-top:10px">
          {% csrf_token %}
          <input type="hidden" name="_action" value="reveal" />
          <button class="btn btn--ghost btn--sm" type="submit">
            <svg class="ico" viewBox="0 0 24 24"><use href="#i-key"/></svg>
            Reveal password
          </button>
        </form>
      {% elif reveal_attempted %}
        <div class="muted" style="margin-top:10px">This link is no longer active.</div>
      {% endif %}
    {% endif %}
  </section>
{% endblock %}

