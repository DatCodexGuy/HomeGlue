{% extends "ui/base.html" %}
{% block title %}Relationships | {{ org.name }}{% endblock %}
{% block content %}
  <section class="panel reveal">
    {% include "ui/_crumbs_simple.html" with crumbs=crumbs %}
    {% include "ui/_list_header.html" with title="Relationships" subtitle="Link any two objects. Use it like a graph." new_url=relationships_new_url %}

    {% if filter_invalid %}
      <div class="warn">
        <div class="warn__title">Invalid filter</div>
        <div class="warn__body muted">The relationship filter <span class="mono">{{ filter_ref }}</span> could not be parsed.</div>
        <div class="mini__actions">
          <a class="btn btn--ghost btn--sm" href="{% url 'ui:relationships_list' %}">Clear</a>
        </div>
      </div>
    {% elif filter_label %}
      <div class="warn">
        <div class="warn__title">Filtered</div>
        <div class="warn__body muted">Showing relationships for <span class="mono">{{ filter_label }}</span>.</div>
        <div class="mini__actions">
          <a class="btn btn--ghost btn--sm" href="{% url 'ui:relationships_list' %}">Clear filter</a>
        </div>
      </div>
    {% endif %}

    <div class="table">
      <div class="row row--head">
        <div>Type</div><div>Source</div><div>Target</div><div>When</div>
      </div>
      {% for r in relationships_view %}
        <a class="row" href="{% url 'ui:relationship_detail' relationship_id=r.id %}">
          <div><span class="pill pill--tiny">{{ r.type_name }}</span></div>
          <div class="mono">{{ r.source.label }}</div>
          <div class="mono">{{ r.target.label }}</div>
          <div class="muted">{{ r.created_at|date:"Y-m-d H:i" }}</div>
        </a>
      {% empty %}
        <div class="empty">
          <div class="empty__title">No relationships yet</div>
          <div class="empty__body"><a class="link" href="{% url 'ui:relationships_new' %}">Create your first relationship</a>.</div>
        </div>
      {% endfor %}
    </div>
  </section>
{% endblock %}
